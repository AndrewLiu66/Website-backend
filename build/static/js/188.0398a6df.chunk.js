(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[188],{1329:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return x}));var n=r(155),a=r(5),i=r(142),o=r(143),c=r(162),s=r(161),u=r(144),l=r(145),p=r(154),d=r.n(p),y=r(148),h=r(159),v=r(146),f=r(175),b=r(151),O=(r(152),r(147),r(150),r(149)),m=r(285),j=r(893),S=r(335);function g(e,t){if(Object(v.j)(e)&&Object(v.j)(t))return null;var r={};return Object(v.k)(t)&&(r.geometry=t.toJSON()),Object(v.k)(e)&&(r.where=e),r}var _=function(e){Object(u.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments))._enabledDataReceived=!1,e.errorString=null,e.connectionStatus="disconnected",e}return Object(o.a)(r,[{key:"initialize",value:function(){var e=this;this.handles.add([Object(f.e)((function(){var t;return null===(t=e.layer)||void 0===t?void 0:t.purgeOptions}),(function(){return e._update()})),Object(f.e)((function(){return e.suspended}),(function(t){t?e._proxy.pauseStream():e._proxy.resumeStream()}))])}},{key:"connectionError",get:function(){if(this.errorString)return new h.a("stream-controller",this.errorString)}},{key:"on",value:function(e,t){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));var n=Object(c.a)(Object(s.a)(r.prototype),"on",this).call(this,e,t),a=this;return{remove:function(){n.remove(),"data-received"===e&&(a._proxy.closed||a.hasEventListener("data-received")||a._proxy.enableEvent("data-received",!1))}}}},{key:"queryLatestObservations",value:function(e,t){var r=this;if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new h.a("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((function(e){var t=m.default.fromJSON(e);return t.features.forEach((function(e){e.layer=r.layer,e.sourceLayer=r.layer})),t}))}},{key:"detach",value:function(){Object(c.a)(Object(s.a)(r.prototype),"detach",this).call(this),this.connectionStatus="disconnected"}},{key:"_createClientOptions",value:function(){var e=this;return Object(a.a)(Object(a.a)({},Object(c.a)(Object(s.a)(r.prototype),"_createClientOptions",this).call(this)),{},{setProperty:function(t){e.set(t.propertyName,t.value)}})}},{key:"_createTileRendererHash",value:function(e){var t="".concat(JSON.stringify(this.layer.purgeOptions),".").concat(JSON.stringify(g(this.layer.definitionExpression,this.layer.geometryDefinition)),")");return Object(c.a)(Object(s.a)(r.prototype),"_createTileRendererHash",this).call(this,e)+t}},{key:"_createServiceOptions",value:function(){var e=Object(n.a)(d.a.mark((function e(){var t,r,n,a,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.layer,r=t.objectIdField,n=t.fields.map((function(e){return e.toJSON()})),a=Object(S.b)(t.geometryType),i=t.timeInfo&&t.timeInfo.toJSON()||null,o=t.spatialReference?t.spatialReference.toJSON():null,e.abrupt("return",{type:"stream",fields:n,geometryType:a,objectIdField:r,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:g(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:t.customParameters});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(j.default);Object(y.a)([Object(b.b)()],_.prototype,"errorString",void 0),Object(y.a)([Object(b.b)({readOnly:!0})],_.prototype,"connectionError",null),Object(y.a)([Object(b.b)()],_.prototype,"connectionStatus",void 0);var x=_=Object(y.a)([Object(O.a)("esri.views.2d.layers.StreamLayerView2D")],_)}}]);